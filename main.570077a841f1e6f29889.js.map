{"version":3,"sources":["webpack:///./images/photo-red.jpg","webpack:///./templates/details-modal.hbs","webpack:///./js/refs.js","webpack:///./js/components/headers-tpl.js","webpack:///./js/decodingJenres.js","webpack:///./js/spinner.js","webpack:///./js/api-servise.js","webpack:///./js/pagination.js","webpack:///./js/modal-login.js","webpack:///./js/login-form.js","webpack:///./js/userLibrary.js","webpack:///./js/homePageRendering.js","webpack:///./js/movieSearch.js","webpack:///./js/modalMovie.js","webpack:///./js/modal-student.js","webpack:///./js/list-students.js"],"names":["module","exports","Handlebars","template","container","depth0","helpers","partials","data","escapeExpression","lambda","stack1","helper","alias1","nullContext","alias2","hooks","helperMissing","alias3","alias4","lookupProperty","parent","propertyName","Object","prototype","hasOwnProperty","call","program","noop","refs","headerSearchWarningShow","document","querySelector","filmsGallery","header","logo","homeLink","spinner","openModalBtn","closeModalBtn","backdrop","logOutbutton","userName","paginationContainer","headerTemplates","homeHeader","myLibraryHeader","modalHeader","decGenres","id","name","spinnerRef","showSpinner","classList","add","hideSpinner","remove","apiServise","query","page","setQuery","value","this","setPage","incrementPage","decrementPage","resetPage","paginateFilms","totalAmountOfFilms","options","totalItems","itemsPerPage","visiblePages","centerAlign","firstItemClassName","lastItemClassName","currentPage","moveButton","disabledMoveButton","moreButton","Pagination","onCloseModal","window","removeEventListener","onEscKeyPress","body","event","code","addEventListener","currentTarget","target","firebase","initializeApp","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","ui","firebaseui","auth","AuthUI","PhoneAuthProvider","filmotekaDatabase","database","ref","currentUserId","console","log","uiConfig","signInFlow","signInOptions","PROVIDER_ID","GoogleAuthProvider","EmailAuthProvider","AnonymousAuthProvider","callbacks","signInSuccessWithAuthResult","authResult","location","reload","setUserData","firebaseUser","uid","userId","userLibrary","userWatched","userQueue","updates","update","e","signOut","localStorage","removeItem","onAuthStateChanged","displayName","innerHTML","setItem","JSON","stringify","parse","getItem","getUserLibraryFromDatabase","start","updateUserWatched","movieData","userData","updateUserDatabase","addToWatchedBtn","contains","movieIndex","findIndex","movie","isInWatched","splice","textContent","toastr","isDublicate","some","push","changeWatchedBtnToRemove","userBase","on","elem","val","getUserWatchedFromDatabase","getUserQueueFromDatabase","changeQueueBtnToRemove","addToQueueBtn","changeQueueBtnToAdd","closeButton","debug","newestOnTop","progressBar","positionClass","preventDuplicates","onclick","showDuration","hideDuration","timeOut","extendedTimeOut","showEasing","hideEasing","showMethod","hideMethod","usersBase","headerTpl","libraryBtn","updateHeaderMarkup","insertAdjacentHTML","libraryHandleClick","renderFilmsGallery","fetch","path","then","response","json","results","total_results","map","poster_path","title","release_date","genre_ids","mapedGenres","genres","filter","genre","includes","slicedMapedGenres","length","slice","markup","toUpperCase","join","split","preventDefault","watchedFilms","queuedFilms","watchedBtn","queueBtn","onLibraryButtonsClick","activeBtn","inactiveBtn","films","updateFilmsLibraryMarkup","localStorageFilms","vote_average","style","display","handleOnPaginationContainerClick","nodeName","button","className","Number","finally","activeBtnRef1","activeBtnRef2","paginateOnClick","catch","searchForm","notice","pagination","listenSearchFormSubmit","form","input","elements","reset","movieId","inputValue","activeLink","closeMovieDetails","filmsGalleryList","res","fetchApiSearch","updateFilmsGalleryMarkup","renderSearchFilmsGallery","userLocalStorageWatched","userLocalStorageQueue","main","closeOnClick","onPressESC","renderLibrary","headerSearchInput","getActiveElements","parentNode","dataset","baseUrl","error","getMovieDetails","newData","vote_count","popularity","Math","ceil","original_title","overview","modalMovieCard","renderMovieDetailsPage","movieDetailedCardTemplate","isInQueue","checkIfIsInUserLibrary","checkIfInQueue","updateUserQueue","markupStudent","src","role","photoRed","reduce","string","link","modal","show","closeModalHandler","close","basicLightbox"],"mappings":"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","file":"main.570077a841f1e6f29889.js","sourcesContent":["module.exports = __webpack_public_path__ + \"images/photo-red.jpg\";","var Handlebars = require(\"../../node_modules/handlebars/runtime.js\");\nfunction __default(obj) { return obj && (obj.__esModule ? obj[\"default\"] : obj); }\nmodule.exports = (Handlebars[\"default\"] || Handlebars).template({\"1\":function(container,depth0,helpers,partials,data) {\n    return \"\\r\\n                    <span class=\\\"modal-info-genres-text-list-data\\\">\"\n    + container.escapeExpression(container.lambda(depth0, depth0))\n    + \"</span>\\r\\n\";\n},\"compiler\":[8,\">= 4.3.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var stack1, helper, alias1=depth0 != null ? depth0 : (container.nullContext || {}), alias2=container.hooks.helperMissing, alias3=\"function\", alias4=container.escapeExpression, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return \"<div class=\\\"modal\\\">\\r\\n    <div class=\\\"modal-container\\\">\\r\\n        <img class=\\\"modal-image\\\" src=\\\"https://image.tmdb.org/t/p/w500\"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"poster_path\") || (depth0 != null ? lookupProperty(depth0,\"poster_path\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"poster_path\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":3,\"column\":69},\"end\":{\"line\":3,\"column\":84}}}) : helper)))\n    + \"\\\" alt=\\\"\"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"title\") || (depth0 != null ? lookupProperty(depth0,\"title\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"title\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":3,\"column\":91},\"end\":{\"line\":3,\"column\":100}}}) : helper)))\n    + \"\\\" />\\r\\n\\r\\n        <div class=\\\"modal-info\\\">\\r\\n            <h2 class=\\\"modal-info-title\\\">\"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"title\") || (depth0 != null ? lookupProperty(depth0,\"title\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"title\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":6,\"column\":41},\"end\":{\"line\":6,\"column\":50}}}) : helper)))\n    + \"</h2>\\r\\n            <p class=\\\"modal-info-vote card-text\\\">\\r\\n                Vote / Votes<span class=\\\"modal-info-vote-average\\\">\"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"vote_average\") || (depth0 != null ? lookupProperty(depth0,\"vote_average\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"vote_average\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":8,\"column\":66},\"end\":{\"line\":8,\"column\":82}}}) : helper)))\n    + \"</span>/<span\\r\\n                    class=\\\"modal-info-vote-count\\\">\"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"vote_count\") || (depth0 != null ? lookupProperty(depth0,\"vote_count\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"vote_count\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":9,\"column\":50},\"end\":{\"line\":9,\"column\":64}}}) : helper)))\n    + \"</span>\\r\\n            </p>\\r\\n            <p class=\\\"modal-info-popularity card-text\\\">\\r\\n                Popularity<span class=\\\"modal-info-popularity-data\\\">\"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"popularity\") || (depth0 != null ? lookupProperty(depth0,\"popularity\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"popularity\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":12,\"column\":67},\"end\":{\"line\":12,\"column\":81}}}) : helper)))\n    + \"</span>\\r\\n            </p>\\r\\n            <p class=\\\"modal-info-title-original card-text\\\">\\r\\n                Original Title<span class=\\\"modal-info-title-original-data\\\">\"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"original_title\") || (depth0 != null ? lookupProperty(depth0,\"original_title\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"original_title\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":15,\"column\":75},\"end\":{\"line\":15,\"column\":93}}}) : helper)))\n    + \"</span>\\r\\n            </p>\\r\\n            <div class=\\\"modal-info-genres\\\">\\r\\n                <p class=\\\"modal-info-genres-text card-text\\\">\\r\\n                    Genre\\r\\n                </p>\\r\\n                <p class=\\\"modal-info-genres-text-list\\\">\"\n    + ((stack1 = lookupProperty(helpers,\"each\").call(alias1,(depth0 != null ? lookupProperty(depth0,\"genres\") : depth0),{\"name\":\"each\",\"hash\":{},\"fn\":container.program(1, data, 0),\"inverse\":container.noop,\"data\":data,\"loc\":{\"start\":{\"line\":21,\"column\":55},\"end\":{\"line\":23,\"column\":29}}})) != null ? stack1 : \"\")\n    + \"                </p>\\r\\n            </div>\\r\\n            <h3 class=\\\"modal-info-about\\\">About</h3>\\r\\n            <p class=\\\"modal-info-description\\\">\\r\\n                \"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"overview\") || (depth0 != null ? lookupProperty(depth0,\"overview\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"overview\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":28,\"column\":16},\"end\":{\"line\":28,\"column\":28}}}) : helper)))\n    + \"\\r\\n            </p>\\r\\n            <div class=\\\"modal-info-buttons-list\\\">\\r\\n                <button type=\\\"button\\\" class=\\\"modal-info-buttons-list-item\\\" id=\\\"js-watched-button\\\">Add to\\r\\n                    watched</button>\\r\\n                <button type=\\\"button\\\" class=\\\"modal-info-buttons-list-item\\\" id=\\\"js-queue-button\\\">Add to queue</button>\\r\\n            </div>\\r\\n        </div>\\r\\n    </div>\\r\\n</div>\";\n},\"useData\":true});","const refs = {\r\n  headerSearchWarningShow() {\r\n    return document.querySelector('#header-search-warning-show');\r\n  },\r\n  filmsGallery: document.querySelector('#films-gallery'),\r\n  header: document.querySelector('.header-container-js'),\r\n  logo: document.querySelector('.header-logo-js'),\r\n  homeLink: document.querySelector('.navigation-list-item-link-home'),\r\n  spinner: document.querySelector('.js-spinner'),\r\n  openModalBtn: document.querySelector('[data-action=\"open-modal\"]'),\r\n  closeModalBtn: document.querySelector('[data-action=\"close-modal\"]'),\r\n  backdrop: document.querySelector('.js-backdrop'),\r\n  logOutbutton: document.querySelector('.js-singOut-button'),\r\n  userName: document.querySelector('.js-display-username'),\r\n  paginationContainer: document.querySelector('#pagination'),\r\n};\r\n\r\nexport default refs;\r\n","const headerTemplates = {\r\n  homeHeader: `<div class=\" header home-header header-container\">\r\n  \r\n  <form action=\"\" class=\"header-search-form\" id=\"search-form\">\r\n    <input type=\"text\" name=\"query\" class=\"header-search-form-input\" placeholder=\"Поиск фильмов\">\r\n    <button class=\"header-search-form-btn\" type=\"submit\"></button>\r\n  </form>\r\n  <p id=\"header-search-warning-show\"  class=\"header-search-warning-show is-hidden\">Search result not successful. Enter the correct movie name and</p>\r\n`,\r\n  myLibraryHeader: `<div class=\" header my-library-header header-container\">\r\n  \r\n  <ul class=\"header-button-list\">\r\n    <li class=\"header-button-item\"><button class=\"header-button header-button-watched is-active-btn\">watched</button></li>\r\n    <li class=\"header-button-item\"><button class=\"header-button header-button-queue\">queue</button></li>\r\n  </ul>\r\n`,\r\n  modalHeader: `<div class=\"header modal-header header-container\">\r\n`,\r\n};\r\nexport default headerTemplates;\r\n","const decGenres = [\r\n{ id: 28, name: \"Action\" },\r\n{id: 12, name: \"Adventure\"},\r\n{id: 16, name: \"Animation\"},\r\n{id: 35, name: \"Comedy\"},\r\n{id: 80, name: \"Crime\"},\r\n{id: 99, name: \"Documentary\"},\r\n{id: 18, name: \"Drama\"},\r\n{id: 10751, name: \"Family\"},\r\n{id: 14, name: \"Fantasy\"},\r\n{id: 36, name: \"History\"},\r\n{id: 27, name: \"Horror\"},\r\n{id: 10402, name: \"Music\"},\r\n{id: 9648, name: \"Mystery\"},\r\n{id: 10749, name: \"Romance\"},\r\n{id: 878, name: \"Science Fiction\"},\r\n{id: 10770, name: \"TV Movie\"},\r\n{id: 53, name: \"Thriller\"},\r\n{id: 10752, name: \"War\"},\r\n{ id: 37, name: \"Western\" }]\r\n\r\nexport default decGenres","const spinnerRef = document.querySelector('.js-spinner');\r\n\r\nfunction showSpinner() {\r\n  spinnerRef.classList.add('is-open');\r\n}\r\n\r\nfunction hideSpinner() {\r\n  spinnerRef.classList.remove('is-open');\r\n}\r\n\r\nexport { showSpinner, hideSpinner };\r\n","const apiServise = {\r\n  query: '',\r\n  page: 1,\r\n\r\n  setQuery(value) {\r\n    this.query = value;\r\n  },\r\n\r\n  setPage(value) {\r\n    this.page = value;\r\n  },\r\n\r\n  incrementPage() {\r\n    this.page += 1;\r\n  },\r\n\r\n  decrementPage() {\r\n    this.page -= 1;\r\n  },\r\n\r\n  resetPage() {\r\n    this.page = 1;\r\n  },\r\n};\r\n\r\nexport default apiServise;\r\n","import Pagination from 'tui-pagination';\r\nimport { renderFilmsGallery} from './homePageRendering';\r\nimport { showSpinner, hideSpinner } from './spinner';\r\nimport apiServise from './api-servise';\r\n\r\nconst refs = {\r\n  filmsGallery: document.querySelector('#films-gallery'),\r\n  paginationContainer: document.querySelector('#pagination'),\r\n};\r\n\r\nfunction paginateFilms(totalAmountOfFilms) {\r\n  const options = {\r\n    totalItems: totalAmountOfFilms,\r\n    itemsPerPage: 20,\r\n    visiblePages: 5,\r\n    page: 1,\r\n    centerAlign: false,\r\n    firstItemClassName: 'tui-first-child',\r\n    lastItemClassName: 'tui-last-child',\r\n    template: {\r\n      page: '<a href=\"#\" class=\"tui-page-btn\">{{page}}</a>',\r\n      currentPage:\r\n        '<strong class=\"tui-page-btn tui-is-selected\">{{page}}</strong>',\r\n      moveButton:\r\n        '<a href=\"#\" class=\"tui-page-btn tui-{{type}}\">' +\r\n        '<span class=\"tui-ico-{{type}}\">{{type}}</span>' +\r\n        '</a>',\r\n      disabledMoveButton:\r\n        '<span class=\"tui-page-btn tui-is-disabled tui-{{type}}\">' +\r\n        '<span class=\"tui-ico-{{type}}\">{{type}}</span>' +\r\n        '</span>',\r\n      moreButton:\r\n        '<a href=\"#\" class=\"tui-page-btn tui-{{type}}-is-ellip\">' +\r\n        '<span class=\"tui-ico-ellip\">...</span>' +\r\n        '</a>',\r\n    },\r\n  };\r\n\r\n  new Pagination('pagination', options);\r\n}\r\n\r\nfunction paginateOnClick(totalAmountOfFilms) {\r\n  refs.paginationContainer.addEventListener(\r\n    'click',\r\n    handleOnPaginationContainerClick\r\n  );\r\n\r\n  function handleOnPaginationContainerClick(event) {\r\n    console.log(\"сработало: \" + handleOnPaginationContainerClick);\r\n    if (event.target.nodeName !== 'A') {\r\n      return;\r\n    }\r\n\r\n    refs.filmsGallery.innerHTML = '';\r\n\r\n    showSpinner();\r\n\r\n    const button = event.target;\r\n\r\n    // console.dir(button);\r\n    // console.log('button.className: ', button.className);\r\n\r\n    switch (button.className) {\r\n      case 'tui-page-btn':\r\n        apiServise.setPage(Number(button.textContent));\r\n        // console.log('page: ', apiServise.page);\r\n        renderFilmsGallery().finally(hideSpinner);\r\n        return;\r\n\r\n      case 'tui-page-btn tui-prev':\r\n        apiServise.decrementPage();\r\n        // console.log('page: ', apiServise.page);\r\n        renderFilmsGallery().finally(hideSpinner);\r\n        return;\r\n\r\n      case 'tui-page-btn tui-next':\r\n        apiServise.incrementPage();\r\n        // console.log('page: ', apiServise.page);\r\n        renderFilmsGallery().finally(hideSpinner);\r\n        return;\r\n\r\n      case 'tui-page-btn tui-first':\r\n        apiServise.resetPage();\r\n        // console.log('page: ', apiServise.page);\r\n        renderFilmsGallery().finally(hideSpinner);\r\n        return;\r\n\r\n      case 'tui-page-btn tui-last':\r\n        apiServise.setPage(totalAmountOfFilms / 20);\r\n        // console.log('page: ', apiServise.page);\r\n        renderFilmsGallery().finally(hideSpinner);\r\n        return;\r\n\r\n      case 'tui-page-btn tui-first-child':\r\n        apiServise.resetPage();\r\n        // console.log('page: ', apiServise.page);\r\n        renderFilmsGallery().finally(hideSpinner);\r\n        return;\r\n\r\n      case 'tui-page-btn tui-prev-is-ellip tui-first-child':\r\n        const activeBtnRef1 = document.querySelector('.tui-is-selected');\r\n        apiServise.setPage(Number(activeBtnRef1.textContent));\r\n        // console.log('page: ', apiServise.page);\r\n        renderFilmsGallery().finally(hideSpinner);\r\n        return;\r\n\r\n      case 'tui-page-btn tui-next-is-ellip tui-last-child':\r\n        const activeBtnRef2 = document.querySelector('.tui-is-selected');\r\n        apiServise.setPage(Number(activeBtnRef2.textContent));\r\n        // console.log('page: ', apiServise.page);\r\n        renderFilmsGallery().finally(hideSpinner);\r\n        return;\r\n\r\n      default:\r\n        console.log('Hi!');\r\n    }\r\n  }\r\n}\r\n\r\nexport { paginateFilms, paginateOnClick };\r\n","import refs from './refs';\r\n\r\nrefs.openModalBtn.addEventListener('click', onOpenModal),\r\n  refs.closeModalBtn.addEventListener('click', onCloseModal),\r\n  refs.backdrop.addEventListener('click', onBackdropClick);\r\n\r\nfunction onOpenModal() {\r\n  window.addEventListener('keydown', onEscKeyPress);\r\n  refs.backdrop.classList.remove('is-hidden');\r\n  document.body.classList.add('show-modal');\r\n}\r\n\r\nfunction onCloseModal() {\r\n  window.removeEventListener('keydown', onEscKeyPress);\r\n  document.body.classList.remove('show-modal');\r\n}\r\n\r\nfunction onBackdropClick(event) {\r\n  if (event.currentTarget === event.target) {\r\n    onCloseModal();\r\n  }\r\n}\r\n\r\nfunction onEscKeyPress(event) {\r\n  const ESC_KEY_CODE = 'Escape';\r\n  const isEscKey = event.code === ESC_KEY_CODE;\r\n\r\n  if (isEscKey) {\r\n    onCloseModal();\r\n  }\r\n}\r\n","import firebase from 'firebase/app';\r\nimport 'firebase/database';\r\nimport 'firebaseui';\r\nimport '../../node_modules/firebaseui/dist/firebaseui.css';\r\nimport './modal-login';\r\nimport refs from './refs';\r\nimport { getUserLibraryFromDatabase } from './userLibrary';\r\n\r\nconst firebaseConfig = {\r\n  apiKey: 'AIzaSyC7TRb9mfyMhzQU-yq3pDKTxl2-zaHwRmo',\r\n  authDomain: 'filmoteka-login.firebaseapp.com',\r\n  databaseURL:\r\n    'https://filmoteka-login-default-rtdb.europe-west1.firebasedatabase.app',\r\n  projectId: 'filmoteka-login',\r\n  storageBucket: 'filmoteka-login.appspot.com',\r\n  messagingSenderId: '658952655924',\r\n  appId: '1:658952655924:web:26304edc0b944079c1e661',\r\n};\r\nfirebase.initializeApp(firebaseConfig);\r\nconst ui = new firebaseui.auth.AuthUI(firebase.auth());\r\nconst uiStart = () => ui.start('#firebaseui-auth-container', uiConfig);\r\n//phoneAuth\r\nnew firebase.auth.PhoneAuthProvider();\r\n\r\n// =======VARIABLE FOR WORKING WITH USER LIBRARY========\r\nexport const filmotekaDatabase = firebase.database().ref('users');\r\nexport let currentUserId = '';\r\nconsole.log(currentUserId);\r\n\r\nconst uiConfig = {\r\n  signInFlow: 'popup',\r\n  signInOptions: [\r\n    firebase.auth.PhoneAuthProvider.PROVIDER_ID,\r\n    firebase.auth.GoogleAuthProvider.PROVIDER_ID,\r\n    firebase.auth.EmailAuthProvider.PROVIDER_ID,\r\n    firebaseui.auth.AnonymousAuthProvider.PROVIDER_ID,\r\n  ],\r\n  callbacks: {\r\n    signInSuccessWithAuthResult: function (authResult) {\r\n      if (authResult) {\r\n        location.reload();\r\n\r\n        setUserData(firebaseUser.uid);\r\n        return true;\r\n      }\r\n    },\r\n  },\r\n};\r\nrefs.logOutbutton.addEventListener('click', e => {\r\n  firebase.auth().signOut();\r\n  localStorage.removeItem('currentUserId');\r\n  window.location.reload();\r\n});\r\n\r\n// login state\r\nfirebase.auth().onAuthStateChanged(firebaseUser => {\r\n  if (firebaseUser) {\r\n    let displayName = firebaseUser.displayName;\r\n    if (displayName === null) {\r\n      displayName = 'guest';\r\n    }\r\n    refs.userName.innerHTML = `${displayName}`;\r\n    document.body.classList.remove('show-modal');\r\n    showLogOutbutton();\r\n    localStorage.setItem('currentUserId', JSON.stringify(firebaseUser.uid));\r\n    currentUserId = JSON.parse(localStorage.getItem('currentUserId'));\r\n    console.log(currentUserId);\r\n\r\n    if (!getUserLibraryFromDatabase(currentUserId)) {\r\n      setUserData(currentUserId);\r\n    }\r\n  } else {\r\n    refs.userName.innerHTML = '';\r\n    showOpenModalBtn();\r\n    uiStart();\r\n  }\r\n});\r\n\r\nfunction showLogOutbutton() {\r\n  refs.logOutbutton.classList.remove('is-hidden');\r\n  refs.openModalBtn.classList.add('is-hidden');\r\n}\r\n\r\nfunction showOpenModalBtn() {\r\n  refs.openModalBtn.classList.remove('is-hidden');\r\n  refs.logOutbutton.classList.add('is-hidden');\r\n}\r\n\r\nfunction setUserData(userId) {\r\n  const userLibrary = {\r\n    userId: userId,\r\n    userWatched: [],\r\n    userQueue: [],\r\n  };\r\n  const updates = {};\r\n  updates['users/' + userId] = userLibrary;\r\n  return firebase.database().ref().update(updates);\r\n}\r\n","import firebase from 'firebase/app';\r\nimport 'firebaseui';\r\nimport 'firebase/database';\r\nimport '../../node_modules/firebaseui/dist/firebaseui.css';\r\nimport refs from './refs';\r\nimport { currentUserId, filmotekaDatabase } from './login-form';\r\n\r\nimport toastr from 'toastr';\r\nimport '../../node_modules/toastr/build/toastr.css';\r\ntoastr.options = {\r\n  closeButton: true,\r\n  debug: false,\r\n  newestOnTop: true,\r\n  progressBar: false,\r\n  positionClass: 'toast-bottom-right',\r\n  preventDuplicates: false,\r\n  onclick: null,\r\n  showDuration: '200',\r\n  hideDuration: '400',\r\n  timeOut: '2000',\r\n  extendedTimeOut: '1000',\r\n  showEasing: 'swing',\r\n  hideEasing: 'linear',\r\n  showMethod: 'fadeIn',\r\n  hideMethod: 'fadeOut',\r\n};\r\n\r\n// ========================VARIABLES==============================\r\n// export let currentUserId = JSON.parse(localStorage.getItem('currentUserId'));\r\n\r\n// let userWatched = getUserWatchedFromDatabase(currentUserId);\r\n// let userQueue = getUserQueueFromDatabase(currentUserId);\r\n\r\n// ==================INITIALAZING DATABASE========================\r\nfilmotekaDatabase.on('value', elem => {\r\n  const usersBase = elem.val();\r\n  console.log(usersBase);\r\n});\r\n\r\n// ==================ADDING TO USER WATCHED LIBRARY===============\r\nexport function updateUserWatched(movieData) {\r\n  let userData = getUserLibraryFromDatabase(currentUserId);\r\n  if (!userData) {\r\n    toastr['error']('Please LOG IN to add the movie');\r\n    return;\r\n  }\r\n\r\n  if (userData.userWatched) {\r\n    if (!userData.userQueue) {\r\n      userData.userQueue = [];\r\n      updateUserDatabase(currentUserId, userData);\r\n      // console.log(userData.userQueue);\r\n    }\r\n    if (refs.addToWatchedBtn.classList.contains('js-is-in-watched')) {\r\n      let movieIndex = userData.userWatched.findIndex(\r\n        movie => movie.id === movieData.id,\r\n      );\r\n      movieData.isInWatched = false;\r\n      userData.userWatched.splice(movieIndex, 1);\r\n      updateUserDatabase(currentUserId, userData);\r\n      changeWatchedBtnToAdd();\r\n      toastr['success']('Removed from your Watched list');\r\n      return userData.userWatched;\r\n    } else {\r\n      const isDublicate = userData.userWatched.some(function (movie) {\r\n        return movie.id === movieData.id;\r\n      });\r\n      if (isDublicate) {\r\n        toastr['warning']('This movie has already been added');\r\n        return userData.userWatched;\r\n      } else if (!isDublicate) {\r\n        movieData.isInWatched = true;\r\n        userData.userWatched.push(movieData);\r\n        updateUserDatabase(currentUserId, userData);\r\n        toastr['success']('Added to your Watched list');\r\n        changeWatchedBtnToRemove();\r\n        return userData.userWatched;\r\n      }\r\n      return userData.userWatched;\r\n    }\r\n  } else {\r\n    movieData.isInWatched = true;\r\n    userData.userWatched = [];\r\n    userData.userWatched.push(movieData);\r\n\r\n    if (!userData.userQueue) {\r\n      userData.userQueue = [];\r\n      updateUserDatabase(currentUserId, userData);\r\n      // console.log(userData.userQueue);\r\n    } else {\r\n      updateUserDatabase(currentUserId, userData);\r\n    }\r\n    toastr['success']('Added to your Watched list');\r\n    changeWatchedBtnToRemove();\r\n  }\r\n  // getUserWatchedFromDatabase(currentUserId);\r\n}\r\n\r\n// ==================ADDING TO USER QUEUE LIBRARY===============\r\nexport function updateUserQueue(movieData) {\r\n  let userData = getUserLibraryFromDatabase(currentUserId);\r\n  if (!userData) {\r\n    toastr['error']('Please LOG IN to add the movie');\r\n    return;\r\n  }\r\n\r\n  // console.log(userData.userQueue);\r\n  if (userData.userQueue) {\r\n    if (!userData.userWatched) {\r\n      userData.userWatched = [];\r\n      updateUserDatabase(currentUserId, userData);\r\n    }\r\n    if (refs.addToQueueBtn.classList.contains('js-is-in-queue')) {\r\n      let movieIndex = userData.userQueue.findIndex(\r\n        movie => movie.id === movieData.id,\r\n      );\r\n      movieData.isInQueue = false;\r\n      userData.userQueue.splice(movieIndex, 1);\r\n      updateUserDatabase(currentUserId, userData);\r\n      changeQueueBtnToAdd();\r\n      toastr['success']('Removed from your Queue');\r\n      return userData.userQueue;\r\n    } else {\r\n      if (isInWatched(movieData)) {\r\n        console.log('you`ve already watched this movie');\r\n        toastr['warning']('You`ve alredy watched this movie');\r\n        return userData.userQueue;\r\n      } else {\r\n        const isDublicate = userData.userQueue.some(function (movie) {\r\n          return movie.id === movieData.id;\r\n        });\r\n\r\n        if (isDublicate) {\r\n          console.log('this movie has already been added');\r\n          toastr['warning']('This movie has already been added');\r\n          return userData.userQueue;\r\n        } else if (!isDublicate) {\r\n          movieData.isInQueue = true;\r\n          userData.userQueue.push(movieData);\r\n          updateUserDatabase(currentUserId, userData);\r\n          toastr['success']('Added to your Queue');\r\n          // изменение текста кнопки\r\n          changeQueueBtnToRemove();\r\n          return userData.userQueue;\r\n        }\r\n      }\r\n    }\r\n  } else {\r\n    if (!userData.userWatched) {\r\n      userData.userWatched = [];\r\n      userData.userQueue = [];\r\n      updateUserDatabase(currentUserId, userData);\r\n      // console.log(userData.userQueue);\r\n    }\r\n    if (isInWatched(movieData)) {\r\n      console.log('you`ve already watched this movie');\r\n      toastr['warning']('You`ve alredy watched this movie');\r\n      return userData.userQueue;\r\n    }\r\n    userData.userQueue = [];\r\n    movieData.isInQueue = true;\r\n    userData.userQueue.push(movieData);\r\n\r\n    if (!userData.userWatched) {\r\n      userData.userQueue = [];\r\n      updateUserDatabase(currentUserId, userData);\r\n    } else {\r\n      updateUserDatabase(currentUserId, userData);\r\n    }\r\n\r\n    toastr['success']('Added to your Queue');\r\n    // изменение текста кнопки\r\n    changeQueueBtnToRemove();\r\n    return userData.userQueue;\r\n  }\r\n}\r\n\r\n// ===============CHECK IF WATCHED MOVIE IS IN QUEUE. DELETE IF SO=================\r\nexport function checkIfInQueue(movieData) {\r\n  let userData = getUserLibraryFromDatabase(currentUserId);\r\n  // console.log(userData.userQueue);\r\n  if (!userData) {\r\n    return;\r\n  }\r\n\r\n  if (userData.userQueue) {\r\n    if (!userData.userWatched) {\r\n      userData.userWatched = [];\r\n      updateUserDatabase(currentUserId, userData);\r\n    }\r\n\r\n    const isDublicate = userData.userQueue.some(function (movie) {\r\n      return movie.id === movieData.id;\r\n    });\r\n    if (isDublicate) {\r\n      let movieIndex = userData.userQueue.findIndex(\r\n        movie => movie.id === movieData.id,\r\n      );\r\n      movieData.isInQueue = false;\r\n      userData.userQueue.splice(movieIndex, 1);\r\n      changeQueueBtnToAdd();\r\n      console.log('movie was deleted wrom Queue and added to watched');\r\n      updateUserDatabase(currentUserId, userData);\r\n    }\r\n    // getUserQueueFromDatabase(currentUserId);\r\n  }\r\n}\r\n\r\n// =============IS THIS MOVIE IS ALREADY WATCHED (DO NOT ADD TO QUEUE)=======\r\nfunction isInWatched(movieData) {\r\n  let userData = getUserLibraryFromDatabase(currentUserId);\r\n\r\n  if (userData.userWatched) {\r\n    const isDublicate = userData.userWatched.some(function (movie) {\r\n      return movie.id === movieData.id;\r\n    });\r\n    console.log(isDublicate);\r\n    return isDublicate;\r\n  } else {\r\n    return false;\r\n  }\r\n}\r\n\r\n// ================ DATABASE FUNCTIONS==========================\r\n// GET ALL LIBRARY DATA FROM DATABASE\r\nexport function getUserLibraryFromDatabase(userId) {\r\n  let userBase = {};\r\n  filmotekaDatabase.on('value', elem => {\r\n    userBase = elem.val()[`${userId}`];\r\n    console.log(userBase);\r\n  });\r\n  return userBase;\r\n}\r\n\r\n// GET USERWATCHED DATA FROM DATABASE\r\nexport function getUserWatchedFromDatabase(userId) {\r\n  if (!userId) {\r\n    return;\r\n  }\r\n  let userWatched = [];\r\n  filmotekaDatabase.on('value', elem => {\r\n    userWatched = elem.val()[`${userId}`][`userWatched`];\r\n    // console.log(userWatched);\r\n  });\r\n  return userWatched;\r\n}\r\n\r\n// GET USERQUEUE DATA FROM DATABASE\r\nexport function getUserQueueFromDatabase(userId) {\r\n  if (!userId) {\r\n    return;\r\n  }\r\n  let userQueue = [];\r\n  filmotekaDatabase.on('value', elem => {\r\n    userQueue = elem.val()[`${userId}`][`userQueue`];\r\n    // console.log(userQueue);\r\n  });\r\n  return userQueue;\r\n}\r\n\r\n// UPDATE DATABaSE\r\nfunction updateUserDatabase(userId, userData) {\r\n  // if (!userData) {\r\n  //   return;\r\n  // }\r\n  const userLibrary = {\r\n    userId: userId,\r\n    userWatched: userData.userWatched,\r\n    userQueue: userData.userQueue,\r\n  };\r\n  const updates = {};\r\n  updates['users/' + userId] = userLibrary;\r\n  return firebase.database().ref().update(updates);\r\n}\r\n\r\n// ==========================BUTTONS HANDLERS===============================\r\nfunction changeWatchedBtnToRemove() {\r\n  refs.addToWatchedBtn.textContent = 'Watched (remove)';\r\n  refs.addToWatchedBtn.classList.add('js-is-in-watched');\r\n}\r\n\r\nfunction changeWatchedBtnToAdd() {\r\n  refs.addToWatchedBtn.textContent = 'Add to Watched';\r\n  refs.addToWatchedBtn.classList.remove('js-is-in-watched');\r\n}\r\n\r\nfunction changeQueueBtnToRemove() {\r\n  refs.addToQueueBtn.textContent = 'In queue (remove)';\r\n  refs.addToQueueBtn.classList.add('js-is-in-queue');\r\n}\r\n\r\nfunction changeQueueBtnToAdd() {\r\n  refs.addToQueueBtn.textContent = 'Add to Queue';\r\n  refs.addToQueueBtn.classList.remove('js-is-in-queue');\r\n}\r\n\r\n// UPDATE BUTTONS IN MOVIECARD IF USER HAS WATCHeD THE MOVIE\r\nexport function checkIfIsInUserLibrary(movieData) {\r\n  let userData = getUserLibraryFromDatabase(currentUserId);\r\n\r\n  if (!userData) {\r\n    toastr['error']('Please LOG IN to add the movie');\r\n    return;\r\n  }\r\n  // CHECK USER WATCHeD\r\n  if (userData.userWatched) {\r\n    const isDublicate = userData.userWatched.some(\r\n      movie => movie.id === movieData.id,\r\n    );\r\n    // console.log(isDublicate);\r\n    if (isDublicate) {\r\n      let movieIndex = userData.userWatched.findIndex(\r\n        movie => movie.id === movieData.id,\r\n      );\r\n      console.log(movieIndex);\r\n      if (userData.userWatched[movieIndex].isInWatched) {\r\n        changeWatchedBtnToRemove();\r\n      }\r\n    }\r\n  }\r\n  // CHECK USER QUEUE\r\n  if (userData.userQueue) {\r\n    const isDublicate = userData.userQueue.some(\r\n      movie => movie.id === movieData.id,\r\n    );\r\n    console.log(isDublicate);\r\n    if (isDublicate) {\r\n      let movieIndex = userData.userQueue.findIndex(\r\n        movie => movie.id === movieData.id,\r\n      );\r\n      console.log(movieIndex);\r\n      if (userData.userQueue[movieIndex].isInQueue) {\r\n        changeQueueBtnToRemove();\r\n      }\r\n    }\r\n  }\r\n}\r\n","import headerTemplates from './components/headers-tpl';\r\nimport genres from './decodingJenres';\r\nimport { paginateFilms, paginateOnClick } from './pagination';\r\nimport { showSpinner, hideSpinner } from './spinner';\r\nimport apiServise from './api-servise';\r\nimport {\r\n  getUserWatchedFromDatabase,\r\n  getUserQueueFromDatabase,\r\n} from './userLibrary';\r\nimport { currentUserId } from './login-form';\r\n\r\nconst refs = {\r\n  header: document.querySelector('.header-container-js'),\r\n  filmsGallery: document.querySelector('#films-gallery'),\r\n  libraryBtn: document.querySelector('.navigation-list-item-link-my-library'),\r\n  paginationContainer: document.querySelector('#pagination'),\r\n  homeLink: document.querySelector('.navigation-list-item-link-home'),\r\n};\r\n\r\nconst path = 'https://api.themoviedb.org/3';\r\nconst key = 'ffddee44025dd24685ea61d637d56d24';\r\n\r\nfunction renderHomePage(headerTpl) {\r\n  apiServise.resetPage();\r\n  showSpinner();\r\n  updateHeaderMarkup(headerTpl);\r\n  setPagination().catch(console.log).finally(hideSpinner);\r\n}\r\n\r\nfunction updateHeaderMarkup(headerTpl) {\r\n  refs.header.innerHTML = '';\r\n  refs.header.insertAdjacentHTML('beforeend', headerTpl);\r\n  refs.libraryBtn.addEventListener('click', libraryHandleClick);\r\n}\r\n\r\nfunction setPagination() {\r\n  return renderFilmsGallery().then(({ totalAmountOfFilms }) => {\r\n    // console.log('totalAmountOfFilms: ', totalAmountOfFilms);\r\n    paginateFilms(totalAmountOfFilms);\r\n    paginateOnClick(totalAmountOfFilms);\r\n  });\r\n}\r\n\r\nfunction renderFilmsGallery() {\r\n  return fetchTrends().then(({ results, total_results }) => {\r\n    // console.log('results: ', results);\r\n    // console.log('total_results: ', total_results);\r\n\r\n    updateFilmsGalleryMarkup(results);\r\n\r\n    const data = {\r\n      totalAmountOfFilms: total_results,\r\n    };\r\n\r\n    return data;\r\n  });\r\n}\r\n\r\nfunction fetchTrends() {\r\n  return fetch(\r\n    `${path}/trending/movie/day?api_key=${key}&page=${apiServise.page}`,\r\n  ).then(response => response.json());\r\n}\r\n\r\nfunction updateFilmsGalleryMarkup(films) {\r\n  // console.log('genres: ', genres);\r\n\r\n  films.map(({ id, poster_path, title, release_date, genre_ids }) => {\r\n    const filteredGenres = genres.filter(genre => genre_ids.includes(genre.id));\r\n    // console.log('filteredGenres: ', filteredGenres);\r\n\r\n    const mapedGenres = filteredGenres.map(({ name }) => name);\r\n    // console.log('mapedGenres: ', mapedGenres);\r\n\r\n    let slicedMapedGenres = [];\r\n\r\n    if (mapedGenres.length < 3) {\r\n      slicedMapedGenres = mapedGenres;\r\n    } else {\r\n      slicedMapedGenres = mapedGenres.slice(0, 2);\r\n      slicedMapedGenres.push('Other');\r\n    }\r\n    // console.log('slicedMapedGenres: ', slicedMapedGenres);\r\n\r\n    if (release_date) {\r\n      release_date;\r\n    } else {\r\n      release_date = 'Unknown release date';\r\n    }\r\n\r\n    const markup = `\r\n<li class=\"films-gallery-item\" data-id=\"${id}\">\r\n  <img\r\n    class=\"films-gallery-item-image\"\r\n    src=\"https://image.tmdb.org/t/p/w342${poster_path}\"\r\n    alt=\"«${title}» film poster\"\r\n  >\r\n  <p class=\"films-gallery-item-title\">${title.toUpperCase()}</p>\r\n  <p class=\"films-gallery-item-info\">${slicedMapedGenres.join(', ')} | ${\r\n      release_date.split('-')[0]\r\n    }</p>\r\n</li>\r\n`;\r\n\r\n    refs.filmsGallery.insertAdjacentHTML('beforeend', markup);\r\n  });\r\n}\r\n\r\n//--------------ОТРИСОВКА БИБЛИОТЕКИ ПОЛЬЗОВАТЕЛЯ----------------\r\nfunction libraryHandleClick(event) {\r\n  event.preventDefault();\r\n  refs.homeLink.classList.remove('current');\r\n  refs.libraryBtn.classList.add('current');\r\n  const watchedFilms = getUserWatchedFromDatabase(currentUserId);\r\n  const queuedFilms = getUserQueueFromDatabase(currentUserId);\r\n  updateHeaderMarkup(headerTemplates.myLibraryHeader);\r\n\r\n  if (document.querySelector('.modal')) {\r\n    document.querySelector('.modal').remove();\r\n  }\r\n\r\n  const watchedBtn = document.querySelector('.header-button-watched');\r\n  const queueBtn = document.querySelector('.header-button-queue');\r\n\r\n  refs.filmsGallery.innerHTML = '';\r\n  refs.paginationContainer.style.display = 'none';\r\n  updateFilmsLibraryMarkup(watchedFilms);\r\n\r\n  function onLibraryButtonsClick(activeBtn, inactiveBtn, films) {\r\n    activeBtn.addEventListener('click', event => {\r\n      event.preventDefault();\r\n      updateFilmsLibraryMarkup(films);\r\n      inactiveBtn.classList.remove('is-active-btn');\r\n      activeBtn.classList.add('is-active-btn');\r\n    });\r\n  }\r\n\r\n  onLibraryButtonsClick(queueBtn, watchedBtn, queuedFilms);\r\n  onLibraryButtonsClick(watchedBtn, queueBtn, watchedFilms);\r\n\r\n  function updateFilmsLibraryMarkup(localStorageFilms) {\r\n    if (!localStorageFilms) {\r\n      refs.filmsGallery.innerHTML = '';\r\n      const message =\r\n        '<div class=\"films-gallery-warning\"><p>No movies here yet. Visit Home to add some =)</p><div>';\r\n      refs.filmsGallery.insertAdjacentHTML('beforeend', message);\r\n      return;\r\n    }\r\n\r\n    refs.filmsGallery.innerHTML = '';\r\n    localStorageFilms.map(\r\n      ({ id, poster_path, title, release_date, genres, vote_average }) => {\r\n        const markup = `\r\n<li class=\"films-gallery-item\" data-id=\"${id}\">\r\n  <img\r\n    class=\"films-gallery-item-image\"\r\n    src=\"https://image.tmdb.org/t/p/w342${poster_path}\"\r\n    alt=\"«${title}» film poster\"\r\n  >\r\n  <p class=\"films-gallery-item-title\">${title.toUpperCase()}</p>\r\n  <p class=\"films-gallery-item-info\">${genres.join(\r\n    ', ',\r\n  )} | ${release_date}<span class=\"modal-info-vote-average library\">${vote_average}</span></p>\r\n</li>\r\n`;\r\n        refs.filmsGallery.insertAdjacentHTML('beforeend', markup);\r\n      },\r\n    );\r\n  }\r\n}\r\n\r\n//-------------------------------------------------------------\r\n\r\nrenderHomePage(headerTemplates.homeHeader);\r\n\r\nexport { renderFilmsGallery, libraryHandleClick };\r\n","import { paginateFilms } from './pagination';\r\nimport genres from './decodingJenres';\r\nimport { showSpinner, hideSpinner } from './spinner';\r\nimport apiServise from './api-servise';\r\n\r\nconst refs = {\r\n  filmsGallery: document.querySelector('#films-gallery'),\r\n  searchForm: document.querySelector('#search-form'),\r\n  notice: document.querySelector('.header-search-warning-show'),\r\n  pagination: document.querySelector('#pagination'),\r\n};\r\n\r\nconst path = 'https://api.themoviedb.org/3';\r\nconst key = 'ffddee44025dd24685ea61d637d56d24';\r\n\r\nfunction listenSearchFormSubmit(event) {\r\n  event.preventDefault();\r\n\r\n  (refs.pagination.innerHTML = ''), apiServise.resetPage();\r\n  // console.log('apiServise.page: ', apiServise.page);\r\n\r\n  refs.notice.classList.add('is-hidden');\r\n\r\n  const form = event.currentTarget;\r\n  const input = form.elements.query;\r\n\r\n  apiServise.setQuery(input.value);\r\n  // console.log('apiServise.query: ', apiServise.query);\r\n\r\n  if (input.value === '') {\r\n    refs.notice.classList.remove('is-hidden');\r\n    refs.notice.textContent =\r\n      'Unable to make a search query. Please enter any text!';\r\n\r\n    // return;\r\n  }\r\n\r\n  showSpinner();\r\n  refs.paginationContainer = document.querySelector('#pagination');\r\n  setPagination(apiServise.query).catch(console.log).finally(hideSpinner);\r\n\r\n  form.reset();\r\n  return;\r\n}\r\n\r\nfunction setPagination() {\r\n  return renderFilmsGallery().then(({ totalAmountOfFilms }) => {\r\n    // console.log('totalAmountOfFilms: ', totalAmountOfFilms);\r\n    paginateFilms(totalAmountOfFilms);\r\n    paginateOnClick(totalAmountOfFilms);\r\n  });\r\n}\r\n\r\nfunction paginateOnClick(totalAmountOfFilms) {\r\n  refs.paginationContainer.addEventListener(\r\n    'click',\r\n    handleOnPaginationContainerClick,\r\n  );\r\n\r\n  function handleOnPaginationContainerClick(event) {\r\n    if (event.target.nodeName !== 'A') {\r\n      return;\r\n    }\r\n\r\n    refs.filmsGallery.innerHTML = '';\r\n\r\n    showSpinner();\r\n\r\n    const button = event.target;\r\n\r\n    // console.dir(button);\r\n    // console.log('button.className: ', button.className);\r\n\r\n    switch (button.className) {\r\n      case 'tui-page-btn':\r\n        apiServise.setPage(Number(button.textContent));\r\n        // console.log('page: ', apiServise.page);\r\n        renderFilmsGallery().finally(hideSpinner);\r\n        return;\r\n\r\n      case 'tui-page-btn tui-prev':\r\n        apiServise.decrementPage();\r\n        // console.log('page: ', apiServise.page);\r\n        renderFilmsGallery().finally(hideSpinner);\r\n        return;\r\n\r\n      case 'tui-page-btn tui-next':\r\n        apiServise.incrementPage();\r\n        // console.log('page: ', apiServise.page);\r\n        renderFilmsGallery().finally(hideSpinner);\r\n        return;\r\n\r\n      case 'tui-page-btn tui-first':\r\n        apiServise.resetPage();\r\n        // console.log('page: ', apiServise.page);\r\n        renderFilmsGallery().finally(hideSpinner);\r\n        return;\r\n\r\n      case 'tui-page-btn tui-last':\r\n        apiServise.setPage(totalAmountOfFilms / 20);\r\n        // console.log('page: ', apiServise.page);\r\n        renderFilmsGallery().finally(hideSpinner);\r\n        return;\r\n\r\n      case 'tui-page-btn tui-first-child':\r\n        apiServise.resetPage();\r\n        // console.log('page: ', apiServise.page);\r\n        renderFilmsGallery().finally(hideSpinner);\r\n        return;\r\n\r\n      case 'tui-page-btn tui-prev-is-ellip tui-first-child':\r\n        const activeBtnRef1 = document.querySelector('.tui-is-selected');\r\n        apiServise.setPage(Number(activeBtnRef1.textContent));\r\n        // console.log('page: ', apiServise.page);\r\n        renderFilmsGallery().finally(hideSpinner);\r\n        return;\r\n\r\n      case 'tui-page-btn tui-next-is-ellip tui-last-child':\r\n        const activeBtnRef2 = document.querySelector('.tui-is-selected');\r\n        apiServise.setPage(Number(activeBtnRef2.textContent));\r\n        // console.log('page: ', apiServise.page);\r\n        renderFilmsGallery().finally(hideSpinner);\r\n        return;\r\n\r\n      default:\r\n        console.log('Hi!');\r\n    }\r\n  }\r\n}\r\n\r\nfunction renderFilmsGallery() {\r\n  return fetchMoviesByKeyword().then(({ results, total_results }) => {\r\n    // console.log(results);\r\n    // console.log(total_results);\r\n\r\n    if (results.length === 0) {\r\n      refs.notice.classList.remove('is-hidden');\r\n      refs.notice.textContent =\r\n        'Your search did not match any films. Please clarify the request!';\r\n\r\n      return;\r\n    }\r\n\r\n    refs.filmsGallery.innerHTML = '';\r\n\r\n    updateFilmsGalleryMarkup(results);\r\n\r\n    const data = {\r\n      totalAmountOfFilms: total_results,\r\n    };\r\n\r\n    return data;\r\n  });\r\n}\r\n\r\nfunction fetchMoviesByKeyword() {\r\n  return fetch(\r\n    `${path}/search/movie?api_key=${key}&language=en-US&page=${apiServise.page}&include_adult=false&query=${apiServise.query}`,\r\n  ).then(response => response.json());\r\n}\r\n\r\nfunction updateFilmsGalleryMarkup(films) {\r\n  // console.log('genres: ', genres);\r\n\r\n  films.map(({ id, poster_path, title, release_date, genre_ids }) => {\r\n    const filteredGenres = genres.filter(genre => genre_ids.includes(genre.id));\r\n    // console.log('filteredGenres: ', filteredGenres);\r\n\r\n    const mapedGenres = filteredGenres.map(({ name }) => name);\r\n    // console.log('mapedGenres: ', mapedGenres);\r\n\r\n    let slicedMapedGenres = [];\r\n\r\n    if (mapedGenres.length < 3) {\r\n      slicedMapedGenres = mapedGenres;\r\n    } else {\r\n      slicedMapedGenres = mapedGenres.slice(0, 2);\r\n      slicedMapedGenres.push('Other');\r\n    }\r\n    // console.log('slicedMapedGenres: ', slicedMapedGenres);\r\n\r\n    if (release_date) {\r\n      release_date;\r\n    } else {\r\n      release_date = 'Unknown release date';\r\n    }\r\n\r\n    const markup = `\r\n<li class=\"films-gallery-item\" data-id=\"${id}\">\r\n  <img\r\n    class=\"films-gallery-item-image\"\r\n    src=\"https://image.tmdb.org/t/p/w342${poster_path}\"\r\n    alt=\"«${title}» film poster\"\r\n  >\r\n  <p class=\"films-gallery-item-title\">${title.toUpperCase()}</p>\r\n  <p class=\"films-gallery-item-info\">${slicedMapedGenres.join(', ')} | ${\r\n      release_date.split('-')[0]\r\n    }</p>\r\n</li>\r\n`;\r\n\r\n    refs.filmsGallery.insertAdjacentHTML('beforeend', markup);\r\n  });\r\n}\r\n\r\n// =====================================================================\r\n\r\nrefs.searchForm.addEventListener('submit', listenSearchFormSubmit);\r\nexport default listenSearchFormSubmit;\r\n","import headerTemplates from './components/headers-tpl';\r\nimport movieDetailedCardTemplate from '../templates/details-modal.hbs';\r\nimport { renderFilmsGallery, libraryHandleClick } from './homePageRendering';\r\nimport listenSearchFormSubmit from './movieSearch';\r\nimport genres from './decodingJenres';\r\nimport refs from './refs';\r\nimport {\r\n  updateUserWatched,\r\n  updateUserQueue,\r\n  checkIfInQueue,\r\n  checkIfIsInUserLibrary,\r\n  getUserWatchedFromDatabase,\r\n  getUserQueueFromDatabase,\r\n} from './userLibrary';\r\nimport { currentUserId } from './login-form';\r\n\r\nconst apiKey = 'ffddee44025dd24685ea61d637d56d24';\r\nconst baseUrl = 'https://api.themoviedb.org/3/movie/';\r\nlet movieId = 0;\r\nlet currentPage = 0;\r\nlet inputValue = '';\r\nlet activeLink = '';\r\nlet activeBtn = '';\r\n\r\nrefs.headerSearchInput = document.querySelector('.header-search-form-input');\r\nrefs.header = document.querySelector('.header-container-js');\r\nrefs.main = document.querySelector('main');\r\nrefs.libraryBtn = document.querySelector(\r\n  '.navigation-list-item-link-my-library',\r\n);\r\nrefs.homeLink = document.querySelector('.navigation-list-item-link-home');\r\nrefs.filmsGalleryList = document.querySelector('#films-gallery');\r\nrefs.pagination = document.querySelector('#pagination');\r\n\r\nrefs.headerSearchInput.addEventListener('change', getInputValue);\r\nrefs.filmsGalleryList.addEventListener('click', handleMovieDetails);\r\n\r\nfunction getActiveElements() {\r\n  activeLink = document.querySelector('.current').textContent;\r\n  currentPage = Number(document.querySelector('.tui-is-selected').textContent);\r\n\r\n  if (activeLink === 'MY LIBRARY') {\r\n    refs.activeBtn = document.querySelector('.is-active-btn');\r\n    activeBtn = refs.activeBtn.textContent;\r\n  }\r\n  return [activeLink, currentPage, activeBtn];\r\n}\r\n\r\nfunction getInputValue(event) {\r\n  inputValue = event.target.value;\r\n  return inputValue;\r\n}\r\n\r\nfunction handleMovieDetails(event) {\r\n  getActiveElements();\r\n\r\n  if (event.target.parentNode.nodeName !== 'LI') {\r\n    return;\r\n  }\r\n\r\n  refs.libraryBtn.addEventListener('click', e => {\r\n    window.removeEventListener('keydown', onPressESC);\r\n    refs.main.removeEventListener('click', closeOnClick);\r\n  });\r\n\r\n  movieId = event.target.parentNode.dataset.id;\r\n  refs.spinner.classList.add('is-open');\r\n  getMovieDetails(baseUrl, apiKey, movieId)\r\n    .then(data => {\r\n      const newData = {\r\n        id: data.id,\r\n        poster_path: data.poster_path,\r\n        title: data.title,\r\n        vote_average: data.vote_average,\r\n        vote_count: data.vote_count,\r\n        popularity: Math.ceil(data.popularity * 10) / 10,\r\n        original_title: data.original_title,\r\n        overview: data.overview,\r\n        genres: data.genres.slice(0, 2).map(({ name }) => name),\r\n        release_date: data.release_date.split('-')[0],\r\n      };\r\n      if (data.genres.length > 2) {\r\n        newData.genres.push('Other');\r\n      }\r\n\r\n      const modalMovieCard = movieDetailedCardTemplate(newData);\r\n      renderMovieDetailsPage(modalMovieCard);\r\n\r\n      window.addEventListener('keydown', onPressESC);\r\n      refs.main.addEventListener('click', closeOnClick);\r\n\r\n      // ADD BUTTUNS & CHECK IF THE MOVIE IS IN USER LIBRARY\r\n      refs.addToWatchedBtn = document.querySelector('#js-watched-button');\r\n      refs.addToQueueBtn = document.querySelector('#js-queue-button');\r\n      checkIfIsInUserLibrary(newData);\r\n\r\n      // WATCHED BUTTON HANDLER\r\n      refs.addToWatchedBtn.addEventListener('click', e => {\r\n        checkIfInQueue(newData);\r\n        updateUserWatched(newData);\r\n      });\r\n\r\n      // QUEUE BUTTON HANDLER\r\n      refs.addToQueueBtn.addEventListener('click', e => {\r\n        updateUserQueue(newData);\r\n      });\r\n    })\r\n    .catch(error => console.log(error))\r\n    .finally(() => {\r\n      refs.spinner.classList.remove('is-open');\r\n    });\r\n}\r\n\r\nfunction getMovieDetails(baseUrl, apiKey, movieId) {\r\n  return fetch(`${baseUrl}${movieId}?api_key=${apiKey}&language=en-US`)\r\n    .then(response => response.json())\r\n    .catch(error => {\r\n      throw error;\r\n    });\r\n}\r\n\r\nfunction renderMovieDetailsPage(modalMovieCard) {\r\n  // document.querySelector('.header-container');\r\n  refs.header.innerHTML = '';\r\n  refs.filmsGalleryList.innerHTML = '';\r\n  // refs.filmsGalleryList.style.display = 'none';\r\n  refs.pagination.style.display = 'none';\r\n  refs.header.insertAdjacentHTML('beforeend', headerTemplates.modalHeader);\r\n  refs.main.insertAdjacentHTML('afterbegin', modalMovieCard);\r\n  refs.libraryBtn.addEventListener('click', libraryHandleClick);\r\n}\r\n\r\nfunction closeMovieDetails() {\r\n  refs.header.innerHTML = '';\r\n  document.querySelector('.modal').remove();\r\n  refs.filmsGalleryList.style.display = 'flex';\r\n\r\n  if (activeLink === 'HOME') {\r\n    refs.header.insertAdjacentHTML('beforeend', headerTemplates.homeHeader);\r\n    refs.searchForm = document.querySelector('#search-form');\r\n    refs.searchForm.addEventListener('submit', listenSearchFormSubmit);\r\n\r\n    if (inputValue !== '') {\r\n      renderSearchFilmsGallery(currentPage, genres, inputValue);\r\n    } else {\r\n      renderFilmsGallery(currentPage, genres);\r\n    }\r\n    refs.pagination.style.display = 'block';\r\n  }\r\n\r\n  if (activeLink === 'MY LIBRARY') {\r\n    refs.header.insertAdjacentHTML(\r\n      'beforeend',\r\n      headerTemplates.myLibraryHeader,\r\n    );\r\n    const userLocalStorageWatched = getUserWatchedFromDatabase(currentUserId);\r\n    const userLocalStorageQueue = getUserQueueFromDatabase(currentUserId);\r\n\r\n    refs.watchedBtn = document.querySelector('.header-button-watched');\r\n    refs.queueBtn = document.querySelector('.header-button-queue');\r\n\r\n    if (document.querySelector('.modal') === null) {\r\n      refs.main.removeEventListener('click', closeOnClick);\r\n      window.removeEventListener('keydown', onPressESC);\r\n    }\r\n\r\n    if (activeBtn === 'watched') {\r\n      renderLibrary(userLocalStorageWatched);\r\n    } else {\r\n      renderLibrary(userLocalStorageQueue);\r\n      refs.watchedBtn.classList.remove('is-active-btn');\r\n      refs.queueBtn.classList.add('is-active-btn');\r\n    }\r\n\r\n    refs.watchedBtn = document.querySelector('.header-button-watched');\r\n    refs.queueBtn = document.querySelector('.header-button-queue');\r\n\r\n    onLibraryButtonsClick(\r\n      refs.queueBtn,\r\n      refs.watchedBtn,\r\n      userLocalStorageQueue,\r\n    );\r\n    onLibraryButtonsClick(\r\n      refs.watchedBtn,\r\n      refs.queueBtn,\r\n      userLocalStorageWatched,\r\n    );\r\n  }\r\n\r\n  inputValue = '';\r\n}\r\n\r\nfunction onPressESC(event) {\r\n  if (event.code === 'Escape') {\r\n    closeMovieDetails();\r\n    window.removeEventListener('keydown', onPressESC);\r\n  }\r\n}\r\n\r\nfunction closeOnClick(event) {\r\n  switch (event.target) {\r\n    case refs.addToWatchedBtn:\r\n    case refs.addToQueueBtn:\r\n      break;\r\n    default:\r\n      closeMovieDetails();\r\n      refs.main.removeEventListener('click', closeOnClick);\r\n  }\r\n}\r\n\r\n// ========RENDER SearchGalleryFilms============\r\nfunction renderSearchFilmsGallery(currentPage, genres, inputValue) {\r\n  return fetchApiSearch(currentPage, inputValue).then(\r\n    ({ results, total_results }) => {\r\n      updateFilmsGalleryMarkup(results, genres);\r\n      const data = {\r\n        totalAmountOfFilms: total_results,\r\n      };\r\n\r\n      return data;\r\n    },\r\n  );\r\n}\r\nfunction fetchApiSearch(currentPage, inputValue) {\r\n  return fetch(\r\n    `https://api.themoviedb.org/3/search/movie?api_key=${apiKey}&language=en-US&query=${inputValue}&page=${currentPage}&include_adult=false`,\r\n  ).then(res => res.json());\r\n}\r\n\r\nfunction updateFilmsGalleryMarkup(films, genres) {\r\n  films.map(({ id, poster_path, title, release_date, genre_ids }) => {\r\n    const filteredGenres = genres.filter(genre => genre_ids.includes(genre.id));\r\n\r\n    const mapedGenres = filteredGenres.map(({ name }) => name);\r\n\r\n    let slicedMapedGenres = [];\r\n\r\n    if (mapedGenres.length < 3) {\r\n      slicedMapedGenres = mapedGenres;\r\n    } else {\r\n      slicedMapedGenres = mapedGenres.slice(0, 2);\r\n      slicedMapedGenres.push('Other');\r\n    }\r\n    const markup = `\r\n<li class=\"films-gallery-item\" data-id=\"${id}\">\r\n  <img\r\n    class=\"films-gallery-item-image\"\r\n    src=\"https://image.tmdb.org/t/p/w342${poster_path}\"\r\n    alt=\"«${title}» film poster\"\r\n  >\r\n  <p class=\"films-gallery-item-title\">${title.toUpperCase()}</p>\r\n  <p class=\"films-gallery-item-info\">${slicedMapedGenres.join(', ')} | ${\r\n      release_date.split('-')[0]\r\n    }</p>\r\n</li>\r\n`;\r\n\r\n    refs.filmsGalleryList.insertAdjacentHTML('beforeend', markup);\r\n  });\r\n}\r\n\r\nfunction onLibraryButtonsClick(activeBtn, inactiveBtn, films) {\r\n  activeBtn.addEventListener('click', event => {\r\n    event.preventDefault();\r\n    refs.filmsGalleryList.innerHTML = '';\r\n    renderLibrary(films);\r\n    inactiveBtn.classList.remove('is-active-btn');\r\n    activeBtn.classList.add('is-active-btn');\r\n  });\r\n}\r\n\r\nfunction renderLibrary(films) {\r\n  if (!films) {\r\n    refs.filmsGallery.innerHTML = '';\r\n    const message =\r\n      '<div class=\"films-gallery-warning\"><p>No movies here yet. Visit Home to add some =)</p><div>';\r\n    refs.filmsGallery.insertAdjacentHTML('beforeend', message);\r\n    return;\r\n  }\r\n  films.map(\r\n    ({ id, poster_path, title, release_date, genres, vote_average }) => {\r\n      const markup = `\r\n<li class=\"films-gallery-item\" data-id=\"${id}\">\r\n  <img\r\n    class=\"films-gallery-item-image\"\r\n    src=\"https://image.tmdb.org/t/p/w342${poster_path}\"\r\n    alt=\"«${title}» film poster\"\r\n  >\r\n  <p class=\"films-gallery-item-title\">${title.toUpperCase()}</p>\r\n  <p class=\"films-gallery-item-info\">${genres.join(\r\n    ', ',\r\n  )} | ${release_date}<span class=\"modal-info-vote-average library\">${vote_average}</span></p>\r\n</li>\r\n`;\r\n\r\n      refs.filmsGalleryList.insertAdjacentHTML('beforeend', markup);\r\n    },\r\n  );\r\n}\r\n","import * as basicLightbox from 'basiclightbox';\r\nimport students from './list-students';\r\n\r\nconst markupStudent = students.reduce(\r\n  (string, { src, link, name, role }) =>\r\n    string +\r\n    `\r\n<div class=\"team-card\">\r\n <img class=\"team-image\" src=\"${src}\" alt=\"${name}\">\r\n    <h2 class=\"team-name\">${name}</h2>\r\n    <p class=\"team-role\">${role}</p>\r\n</div>`,\r\n  '',\r\n);\r\n\r\nconst container = document.querySelector('.open-modal-develop');\r\n\r\ncontainer.addEventListener('click', openModalStudent);\r\n\r\nconst modal = basicLightbox.create(\r\n  `<div class=\"team-wrapper\">${markupStudent}</div>`,\r\n);\r\n\r\nfunction openModalStudent(e) {\r\n  modal.show();\r\n\r\n  window.addEventListener('keydown', closeModalHandler);\r\n\r\n  function closeModalHandler(e) {\r\n    if (e.code === 'Escape') {\r\n      modal.close();\r\n      window.removeEventListener('keydown', closeModalHandler);\r\n    }\r\n  }\r\n}\r\n","import photoRed from '../images/photo-red.jpg';\r\n\r\nconst students = [\r\n  {\r\n    src: 'https://ca.slack-edge.com/T01301DGATC-U013V8Q7HU1-b66c40babb7d-192',\r\n    name: 'Rostyslav Zahorulko',\r\n    role: 'Team-Lead',\r\n  },\r\n  {\r\n    src: 'https://ca.slack-edge.com/T01AD58HHH7-U01A5LX36UT-d79e95c64409-5122',\r\n    name: 'Arkadii Basovych',\r\n    role: 'Scrum Master',\r\n  },\r\n  {\r\n    src: 'https://ca.slack-edge.com/T01AD58HHH7-U01A9LTBZA8-06cbe1fcd7b6-512',\r\n    name: 'Oksana Cherepanova',\r\n    role: 'Developer',\r\n  },\r\n  {\r\n    src: 'https://ca.slack-edge.com/T01AD58HHH7-U019WN8GZJS-380c6cd06280-512',\r\n    name: 'Natalia Duvirak',\r\n    role: 'Developer',\r\n  },\r\n  {\r\n    src: 'https://ca.slack-edge.com/T01AD58HHH7-U01AT710YLQ-3a6d16128ec7-512',\r\n    name: 'David<br>Shakaya',\r\n    role: 'Developer',\r\n  },\r\n  {\r\n    src: 'https://ca.slack-edge.com/T01AD58HHH7-U01A3HTTQE6-4c9caf01316f-512',\r\n    name: 'Oleksii Maistriuk',\r\n    role: 'Developer',\r\n  },\r\n  {\r\n    src: 'https://ca.slack-edge.com/T01AD58HHH7-U01ATCQ5GKA-46dd5abf2215-512',\r\n    name: 'Zoe<br>Baletska',\r\n    role: 'Developer',\r\n  },\r\n  {\r\n    src: 'https://ca.slack-edge.com/T01AD58HHH7-U019WKPR89L-21c1789a67bc-512',\r\n    name: 'Serhii<br>Koziuba',\r\n    role: 'Developer',\r\n  },\r\n  {\r\n    src: 'https://ca.slack-edge.com/T01AD58HHH7-U019WP9NVN2-6122ddfef0b5-512',\r\n    name: 'Konstantin Bruno',\r\n    role: 'Developer',\r\n  },\r\n  {\r\n    src: `${photoRed}`,\r\n    name: 'Iryna<br>Redka',\r\n    role: 'Developer',\r\n  },\r\n  {\r\n    src: 'https://ca.slack-edge.com/T01AD58HHH7-U019P8QMTUP-6513aed3ebc7-512',\r\n    name: 'Larysa Smyrnova',\r\n    role: 'Developer',\r\n  },\r\n];\r\nexport default students;"],"sourceRoot":""}